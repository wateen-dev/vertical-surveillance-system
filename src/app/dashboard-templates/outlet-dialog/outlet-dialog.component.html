<div class="modal-container mat-elevation-z8">

    <!-- Header -->
    <mat-toolbar color="primary" class="modal-header">
        <span class="header-title">
            {{ data.selectedOutlet.name | titlecase }} — Outlet Details
        </span>
        <button mat-icon-button class="close-btn" (click)="closeDialog()">
            <mat-icon>close</mat-icon>
        </button>
    </mat-toolbar>

    <!-- Main Body -->
    <div class="modal-body">

        <!-- Outlet Info -->
        <mat-card class="outlet-card mat-elevation-z4">
            <mat-card-header>
                <mat-card-title>{{ data.selectedOutlet.name }}</mat-card-title>
                <mat-card-subtitle>
                    {{ data.selectedOutlet.type | titlecase }} | {{ data.selectedOutlet.status }}
                </mat-card-subtitle>
            </mat-card-header>

            <mat-card-content>
                <div class="outlet-info-container">
                    <h4 class="section-heading">Outlet Overview</h4>

                    <div class="outlet-info-grid">
                        <div class="info-item" *ngIf="data.selectedOutlet.rating">
                            <mat-icon class="info-icon">star</mat-icon>
                            <!-- <div class="info-content">
                                <label>Rating</label>
                                <span>{{ data.selectedOutlet.rating || 'N/A' }} ⭐</span>
                            </div> -->
                            <div class="info-content">
                                <label>Rating</label>
                                <span class="star-rating">
                                    <ng-container *ngFor="let star of getStars(data.selectedOutlet.rating || 0)">
                                        <mat-icon *ngIf="star === 'full'" class="star-full">star</mat-icon>
                                        <mat-icon *ngIf="star === 'half'" class="star-half">star_half</mat-icon>
                                        <mat-icon *ngIf="star === 'empty'" class="star-empty">star_outline</mat-icon>
                                    </ng-container>
                                    <span class="rating-number">{{ data.selectedOutlet.rating || 'N/A' }}</span>
                                </span>
                            </div>

                        </div>

                        <div class="info-item">
                            <mat-icon class="info-icon">place</mat-icon>
                            <div class="info-content">
                                <label>Address</label>
                                <span>{{ data.selectedOutlet.address || 'Not available' }}</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <mat-icon class="info-icon">phone</mat-icon>
                            <div class="info-content">
                                <label>Phone</label>
                                <span>{{ data.selectedOutlet.phone || 'Not available' }}</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <mat-icon class="info-icon">public</mat-icon>
                            <div class="info-content">
                                <label>Website</label>
                                <span>
                                    <a *ngIf="data.selectedOutlet.website" [href]="data.selectedOutlet.website"
                                        target="_blank">
                                        {{ data.selectedOutlet.website }}
                                    </a>
                                    <span *ngIf="!data.selectedOutlet.website">N/A</span>
                                </span>
                            </div>
                        </div>

                        <div class="info-item">
                            <mat-icon class="info-icon">business</mat-icon>
                            <div class="info-content">
                                <label>Status</label>
                                <span>{{ data.selectedOutlet.status || 'Unknown' }}</span>
                            </div>
                        </div>

                        <div class="info-item">
                            <mat-icon class="info-icon">schedule</mat-icon>
                            <div class="info-content">
                                <label>Open Now</label>
                                <span [ngClass]="data.selectedOutlet.openNow ? 'open' : 'closed'">
                                    {{ data.selectedOutlet.openNow ? 'Yes' : 'No' }}
                                </span>
                            </div>
                        </div>
                    </div>

                </div>


                <div *ngIf="data.selectedOutlet.hours?.length" class="hours-section">
                    <h4>Opening Hours</h4>
                    <div class="hours-grid">
                        <div class="hour-item" *ngFor="let day of data.selectedOutlet.hours">
                            <mat-icon class="clock-icon">schedule</mat-icon>
                            <span class="hour-text">{{ day }}</span>
                        </div>
                    </div>
                </div>

            </mat-card-content>
        </mat-card>

        <!-- ===== User Reviews Section ===== -->
        <mat-card class="reviews-card mat-elevation-z8">
            <mat-card-header>
                <mat-card-title>
                    <mat-icon class="review-icon">rate_review</mat-icon>
                    <span class="review-heading">User Reviews</span>
                </mat-card-title>
            </mat-card-header>

            <mat-card-content>
                <div *ngIf="reviewsDataSource.data.length > 0; else noReviews">
                    <table mat-table [dataSource]="reviewsDataSource" class="mat-elevation-z2 review-table">

                        <!-- User Column -->
                        <ng-container matColumnDef="user">
                            <th mat-header-cell *matHeaderCellDef>User</th>
                            <td mat-cell *matCellDef="let element">
                                {{ element.user }}
                            </td>
                        </ng-container>

                        <!-- Comment Column -->
                        <ng-container matColumnDef="comment">
                            <th mat-header-cell *matHeaderCellDef>Comment</th>
                            <td mat-cell *matCellDef="let element" class="comment-cell">
                                “{{ element.comment }}”
                            </td>
                        </ng-container>

                        <!-- Stars Column -->
                        <ng-container matColumnDef="stars">
                            <th mat-header-cell *matHeaderCellDef>Stars</th>
                            <td mat-cell *matCellDef="let element" class="stars-cell">
                                <span class="stars">{{ element.stars }} ⭐</span>
                            </td>
                        </ng-container>

                        <!-- Table Rows -->
                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    </table>

                    <mat-paginator [pageSizeOptions]="[5, 10]" showFirstLastButtons></mat-paginator>
                </div>

                <ng-template #noReviews>
                    <p class="no-reviews-text">No reviews available for this outlet.</p>
                </ng-template>
            </mat-card-content>
        </mat-card>

    </div>

</div>