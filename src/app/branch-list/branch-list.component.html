<div class="branches-container">
     <!-- Loading spinner -->
  <div class="loading-overlay" *ngIf="isLoading">
    <div class="spinner"></div>
  </div>
  <mat-card class="branches-card mat-elevation-z4">

    <div class="card-head">
     <h2 class="branches-heading">Registered Branches</h2>

      <!-- ðŸ” Search -->
      <mat-form-field appearance="outline" class="search-box">
        <mat-label>Search</mat-label>
        <input
          matInput
          (keyup)="applySearch($event)"
          placeholder="Search branch name, city, address..."
        />
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </div>

    <div class="table-wrapper">
      <table mat-table [dataSource]="dataSource" matSort class="branches-table">

        <!-- Branch ID -->
        <ng-container matColumnDef="branchId">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Branch ID</th>
          <td mat-cell *matCellDef="let b">{{ b.branchId }}</td>
        </ng-container>
<!-- Name -->
<ng-container matColumnDef="branchName">
  <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
  <td mat-cell *matCellDef="let b">
    <span class="truncate-text" matTooltip="{{ b.branchName }}">
      {{ b.branchName }}
    </span>
  </td>
</ng-container>

<!-- Address -->
<ng-container matColumnDef="address">
  <th mat-header-cell *matHeaderCellDef>Address</th>
  <td mat-cell *matCellDef="let b">
    <span class="truncate-text" matTooltip="{{ b.address }}">
      {{ b.address }}
    </span>
  </td>
</ng-container>

        <!-- City -->
        <ng-container matColumnDef="city">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>City</th>
          <td mat-cell *matCellDef="let b">{{ b.city }}</td>
        </ng-container>

        <!-- Status -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let b">
            <mat-chip [ngClass]="b.isDeleted ? 'chip-closed' : 'chip-active'">
              {{ b.isDeleted ? 'Inactive' : 'Active' }}
            </mat-chip>
          </td>
        </ng-container>

        <!-- Created On -->
        <ng-container matColumnDef="createdOn">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Created On</th>
          <td mat-cell *matCellDef="let b">
            {{ b.createdOn | date: 'medium' }}
          </td>
        </ng-container>

        <!-- Created By -->
        <ng-container matColumnDef="createdBy">
          <th mat-header-cell *matHeaderCellDef>Created By</th>
          <td mat-cell *matCellDef="let b">{{ b.createdBy }}</td>
        </ng-container>

        <!-- Actions -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let b">
            <button mat-icon-button color="primary" (click)="editBranch(b)">
              <mat-icon>edit</mat-icon>
            </button>

            <button mat-icon-button color="warn" (click)="openDeleteDialog(b)" [disabled]="b.isDeleted">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>

      <mat-paginator
        [pageSizeOptions]="[7, 10, 20, 30]"
        showFirstLastButtons
      ></mat-paginator>
    </div>
  </mat-card>
  <ng-template #deleteDialog>
  <div class="delete-dialog-container">

    <!-- Header -->
    <div class="dialog-header">
      <h2 class="main-title">Delete Branch - {{ selectedBranchName }}</h2>
      <!-- <h3 class="branch-title"></h3> -->
    </div>

    <!-- Body -->
    <div class="dialog-body">
      <p class="delete-warning">
        Are you absolutely sure you want to delete this branch?
      </p>
      <p class="delete-subtext">
        This action will soft delete the branch. It will no longer appear in the list,
        but can be restored by an admin.
      </p>
    </div>

    <!-- Footer Actions -->
    <div class="dialog-footer">
      <button mat-raised-button class="btn-cancel" (click)="dialogRef.close()">
        Cancel
      </button>

      <button mat-raised-button class="btn-delete" (click)="confirmDelete()">
        Delete Branch
      </button>
    </div>

  </div>
</ng-template>


</div>
